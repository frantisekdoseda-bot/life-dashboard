<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Life Dashboard</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
margin:0;
font-family:system-ui;
background:#0b1220;
color:white;
padding:20px;
}
.card{
background:#121a2e;
padding:20px;
border-radius:20px;
margin-bottom:20px;
}
button{
background:#4f46e5;
border:none;
padding:15px 25px;
border-radius:12px;
color:white;
font-size:18px;
}
.big{font-size:32px;font-weight:700}
.small{opacity:.7}
</style>
</head>

<body>

<div id="login" class="card">
<div class="big">Life dashboard</div>
<br>
<button onclick="login()">Přihlásit přes Google</button>
</div>

<div id="app" style="display:none">

<div class="card">
<div class="small">TENTO TÝDEN</div>
<div class="big" id="money">Načítám…</div>
</div>

<div class="card">
<div class="small">POČASÍ Praha</div>
<div class="big" id="weather">Načítám…</div>
</div>

<div class="card">
<div class="small">NEJBLIŽŠÍ TRAM</div>
<div class="big" id="tram">Načítám…</div>
</div>

<div class="card">
<div class="small">KALENDÁŘ</div>
<div id="calendar">Načítám…</div>
</div>

</div>

<script>
const supabase = window.supabase.createClient(
  "https://khpjmtcewzavuxkbcgu.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
);

async function login(){
await supabase.auth.signInWithOAuth({
provider:'google'
});
}

supabase.auth.getSession().then(({data})=>{
if(data.session){
startApp();
}
});

function startApp(){
document.getElementById("login").style.display="none";
document.getElementById("app").style.display="block";

loadWeather();
loadTram();
loadCalendar();
loadMoney();
}

async function loadWeather(){
try{
let r = await fetch("https://api.open-meteo.com/v1/forecast?latitude=50.0755&longitude=14.4378&current_weather=true");
let j = await r.json();
document.getElementById("weather").innerText =
j.current_weather.temperature+"°C";
}catch{
document.getElementById("weather").innerText="chyba";
}
}

function loadTram(){
document.getElementById("tram").innerText="Strossmayerovo nám 3 min";
}

function loadCalendar(){
document.getElementById("calendar").innerHTML=
`<iframe src="https://calendar.google.com/calendar/embed?src=cs.czech%23holiday%40group.v.calendar.google.com&ctz=Europe%2FPrague"
style="border:0" width="100%" height="300"></iframe>`;
}

function loadMoney(){
document.getElementById("money").innerText="0 Kč dnes";
}
</script>

</body>
</html>
