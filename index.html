<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Life Dashboard</title>

<style>
body{
margin:0;
font-family:system-ui;
background:#0b1220;
color:white;
padding:20px;
}
.card{
background:#121a2e;
padding:20px;
border-radius:20px;
margin-bottom:20px;
}
.big{font-size:34px;font-weight:700}
.small{opacity:.6}
</style>
</head>

<body>

<div class="card">
<div class="small">POÄŒASÃ</div>
<div class="big" id="weather">NaÄÃ­tÃ¡mâ€¦</div>
<div id="details"></div>
</div>

<div class="card">
<div class="small">UV / MÄšSÃC</div>
<div class="big" id="astro">NaÄÃ­tÃ¡mâ€¦</div>
</div>

<div class="card">
<div class="small">TRAM VELETÅ½NÃ / STROSS</div>
<div class="big" id="tram">NaÄÃ­tÃ¡mâ€¦</div>
</div>

<div class="card">
<div class="small">KALENDÃÅ˜</div>
<div id="calendar"></div>
</div>

<script>
let lat, lon;

navigator.geolocation.getCurrentPosition(pos=>{
lat = pos.coords.latitude;
lon = pos.coords.longitude;
start();
},()=>{
document.getElementById("weather").innerText="Poloha blokovÃ¡na";
});

async function start(){
loadWeather();
loadTram();
loadCalendar();

setInterval(loadTram,60000);
setInterval(loadWeather,900000);
}

async function loadWeather(){
let url=`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,apparent_temperature,precipitation,weathercode,uv_index&daily=moon_phase&timezone=auto`;

let r=await fetch(url);
let j=await r.json();

let t=j.current.temperature_2m;
let feel=j.current.apparent_temperature;
let rain=j.current.precipitation;
let uv=j.current.uv_index;

document.getElementById("weather").innerText=
`${t}Â°C (pocit ${feel}Â°C)`;

document.getElementById("details").innerText=
`DÃ©Å¡Å¥: ${rain}mm   UV:${uv}`;

let moon=j.daily.moon_phase[0];
let phase="ğŸŒ‘";
if(moon>0.1)phase="ğŸŒ’";
if(moon>0.25)phase="ğŸŒ“";
if(moon>0.5)phase="ğŸŒ•";
if(moon>0.75)phase="ğŸŒ–";

document.getElementById("astro").innerText=
`UV ${uv}   ${phase}`;
}

function loadTram(){
document.getElementById("tram").innerText=
"Stross 2 min â€¢ VeletrÅ¾nÃ­ 4 min";
}

function loadCalendar(){
document.getElementById("calendar").innerHTML=
`<iframe src="https://calendar.google.com/calendar/embed?src=cs.czech%23holiday%40group.v.calendar.google.com&ctz=Europe%2FPrague"
style="border:0" width="100%" height="300"></iframe>`;
}
</script>

</body>
</html>
