<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Life Dashboard</title>

<style>
body{
background:#0b0f14;
color:white;
font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;
padding:16px;
margin:0;
}

.card{
background:#111723;
padding:18px;
border-radius:20px;
margin-bottom:16px;
box-shadow:0 10px 25px rgba(0,0,0,0.35);
}

.big{font-size:28px;font-weight:600;}
.small{opacity:.7;font-size:13px;margin-bottom:6px;}
.row{display:flex;justify-content:space-between;margin-top:6px;font-size:14px;}
.ok{color:#51cf66;}
.warn{color:#ff6b6b;}
iframe{border:none;width:100%;height:300px;border-radius:12px;}
</style>
</head>

<body>

<!-- POÄŒASÃ -->
<div class="card">
<div class="small">POÄŒASÃ</div>
<div class="big" id="temp">NaÄÃ­tÃ¡m...</div>
<div id="weatherDetails"></div>
</div>

<!-- FINANCE -->
<div class="card">
<div class="small">TENTO TÃDEN</div>
<div class="big" id="spent">0 KÄ</div>
<div class="row"><span>Limit</span><span>10 000 KÄ</span></div>
<div class="row"><span>ZbÃ½vÃ¡</span><span id="left">10 000 KÄ</span></div>
<div class="row"><span>Status</span><span id="status" class="ok">V pohodÄ›</span></div>
</div>

<!-- GOOGLE KALENDÃÅ˜ -->
<div class="card">
<div class="small">KALENDÃÅ˜</div>
<iframe src="https://calendar.google.com/calendar/embed?height=600&wkst=1&ctz=Europe%2FPrague&showPrint=0&src=ZnJhbnRpc2VrZG9zZWRhQGdtYWlsLmNvbQ&src=YjcwcjU4N2puYTZkMHFjbjJmZmFmcWFxdGNAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ&src=aHQzamxmYWFjNWxmZDYyNjN1bGZoNHRxbDhAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ&src=YjMzbnJvMjAwcmg4OXE4MzdndTNobW12b2tAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ&src=dHJhbmcuZG9zZWRhQGdtYWlsLmNvbQ&src=dHJhbmcuc2Vkb3ZhQGdtYWlsLmNvbQ&src=Y3MuY3plY2gjaG9saWRheUBncm91cC52LmNhbGVuZGFyLmdvb2dsZS5jb20&color=%230b8043&color=%23d50000&color=%23616161&color=%23039be5&color=%23e4c441&color=%23e4c441&color=%23616161" style="border:solid 1px #777" width="800" height="600" frameborder="0" scrolling="no"></iframe>
</div>

<!-- JÃZDNÃ Å˜ÃDY -->
<div class="card">
  <div class="small">MHD (Praha)</div>
  <div id="mhd">NaÄÃ­tÃ¡m spoje...</div>
</div>

<script>
/* FINANCE */
let total = localStorage.getItem("spent") ? Number(localStorage.getItem("spent")) : 0;
const limit = 10000;

function renderFinance(){
document.getElementById("spent").innerText = total + " KÄ";
let left = limit-total;
if(left<0) left=0;
document.getElementById("left").innerText = left + " KÄ";
if(total>limit){
document.getElementById("status").innerText="PÅ™es limit";
document.getElementById("status").className="warn";
}else{
document.getElementById("status").innerText="V pohodÄ›";
document.getElementById("status").className="ok";
}
}
renderFinance();

/* POÄŒASÃ */
navigator.geolocation.getCurrentPosition(pos=>{
let lat=pos.coords.latitude;
let lon=pos.coords.longitude;

fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&daily=sunrise,sunset,uv_index_max&timezone=auto`)
.then(r=>r.json())
.then(data=>{
document.getElementById("temp").innerText=data.current_weather.temperature+"Â°C";

let sunrise=data.daily.sunrise[0].split("T")[1].slice(0,5);
let sunset=data.daily.sunset[0].split("T")[1].slice(0,5);
let uv=data.daily.uv_index_max[0];

document.getElementById("weatherDetails").innerHTML=
`
<div class="row"><span>UV index</span><span>${uv}</span></div>
<div class="row"><span>VÃ½chod</span><span>${sunrise}</span></div>
<div class="row"><span>ZÃ¡pad</span><span>${sunset}</span></div>
`;
});
});

const moon = Math.floor((Date.now()/1000/86400)%29.53);
let phase = "";

if(moon<2) phase="ğŸŒ‘ Nov";
else if(moon<7) phase="ğŸŒ’ DorÅ¯stÃ¡";
else if(moon<9) phase="ğŸŒ“ PrvnÃ­ ÄtvrÅ¥";
else if(moon<14) phase="ğŸŒ” DorÅ¯stÃ¡";
else if(moon<16) phase="ğŸŒ• ÃšplnÄ›k";
else if(moon<22) phase="ğŸŒ– UbÃ½vÃ¡";
else if(moon<24) phase="ğŸŒ— PoslednÃ­ ÄtvrÅ¥";
else phase="ğŸŒ˜ UbÃ½vÃ¡";

document.getElementById("temp").innerText += " â€¢ " + phase;

/* JÃZDNÃ Å˜ÃDY â€“ jednoduchÃ¡ PID ukÃ¡zka */
<script>
async function loadMHD() {
  const stops = ["VeletrÅ¾nÃ­ palÃ¡c", "Strossmayerovo nÃ¡mÄ›stÃ­"];

  let output = "";

  for (let stop of stops) {
    try {
      const res = await fetch(`https://api.golemio.cz/v2/pid/departureboards?names[]=${encodeURIComponent(stop)}&limit=3`, {
        headers: { "x-access-token": "public-demo" }
      });

      const data = await res.json();

      if (data.departures && data.departures.length > 0) {
        output += `<b>${stop}</b><br>`;
        data.departures.slice(0,3).forEach(dep=>{
          output += `${dep.route.short_name} â†’ ${dep.trip.headsign} (${dep.departure_timestamp.predicted.substring(11,16)})<br>`;
        });
        output += "<br>";
      }
    } catch(e) {
      output += `${stop} â€“ chyba naÄÃ­tÃ¡nÃ­<br><br>`;
    }
  }

  document.getElementById("mhd").innerHTML = output;
}

loadMHD();
</script>


</body>
</html>
