<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Life Dashboard</title>

<style>
body{
margin:0;
font-family:-apple-system, BlinkMacSystemFont, system-ui;
background:#0b1220;
color:white;
}

.wrap{
padding:20px;
max-width:500px;
margin:auto;
}

.card{
background:linear-gradient(180deg,#0f1b35,#0b1220);
padding:22px;
border-radius:26px;
margin-bottom:18px;
box-shadow:0 10px 30px rgba(0,0,0,.35);
}

.big{
font-size:34px;
font-weight:700;
}

.row{
opacity:.9;
margin-top:6px;
}

.stop{
margin-top:10px;
padding-top:10px;
border-top:1px solid rgba(255,255,255,.08);
}

.stopname{
color:#7dd3fc;
font-weight:700;
font-size:18px;
margin-bottom:6px;
}

.line{
font-size:15px;
margin:2px 0;
opacity:.95;
}

.small{
opacity:.6;
font-size:12px;
margin-top:6px;
}
</style>
</head>

<body>
<div class="wrap">

<div class="card" id="weather">
<div class="big" id="temp">Naƒç√≠t√°m‚Ä¶</div>
<div class="row" id="meta"></div>
<div class="row" id="sun"></div>
<div class="small" id="forecast"></div>
</div>

<div class="card">
<div class="stop">
<div class="stopname">üöã Veletr≈æn√≠ pal√°c</div>
<div id="v">Naƒç√≠t√°m‚Ä¶</div>
</div>

<div class="stop">
<div class="stopname">üöã Strossmayerovo n√°m.</div>
<div id="s">Naƒç√≠t√°m‚Ä¶</div>
</div>
</div>

</div>

<script>
const GOLEMIO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NDg0MCwiaWF0IjoxNzcxODA0NzA1LCJleHAiOjExNzcxODA0NzA1LCJpc3MiOiJnb2xlbWlvIiwianRpIjoiZDQzZDVlMDktNmVhZS00ZGQwLWEzMTAtMjI5YjZmZTQ4NmE0In0.5Wgnlm02CytmAfA-N6_-kXCyRhidvhcaQ7-XaO9GGsw"; // sem vlo≈æ api

// ===== poƒças√≠ =====
async function loadWeather(){
let lat=50.098;
let lon=14.432;

let r=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m,precipitation,windspeed_10m,apparent_temperature,uv_index&daily=sunrise,sunset&timezone=Europe%2FPrague`);
let j=await r.json();

document.getElementById("temp").innerHTML=
`${j.current_weather.temperature}¬∞ <span style="opacity:.6;font-size:22px">(${Math.round(j.hourly.apparent_temperature[0])}¬∞)</span>`;

document.getElementById("meta").innerHTML=
`üåß ${j.hourly.precipitation[0]}mm &nbsp; üí® ${j.current_weather.windspeed}km/h &nbsp; UV ${j.hourly.uv_index[0]}`;

let sunrise=j.daily.sunrise[0].substring(11,16);
let sunset=j.daily.sunset[0].substring(11,16);

document.getElementById("sun").innerHTML=
`‚òÄÔ∏è ${sunrise} &nbsp; üåá ${sunset}`;

let f="";
for(let i=1;i<6;i++){
let h=j.hourly.time[i].substring(11,16);
let t=j.hourly.temperature_2m[i];
let r=j.hourly.precipitation[i];
f+=`${h} ${t}¬∞ ${r}mm &nbsp; `;
}
document.getElementById("forecast").innerHTML=f;
}

// ===== PID =====
async function stop(name,id,el){
try{
let r=await fetch(`https://api.golemio.cz/v2/pid/departureboards?ids=${id}&limit=12`,{
headers:{"x-access-token":GOLEMIO}
});
let j=await r.json();

if(!j.departures||j.departures.length==0){
document.getElementById(el).innerHTML="≈æ√°dn√© spoje";
return;
}

let html="";
j.departures.slice(0,8).forEach(d=>{
let line=d.route.short_name;
let dir=d.trip.headsign;
let ts=d.departure_timestamp.predicted||d.departure_timestamp.scheduled;
let t=new Date(ts).toLocaleTimeString("cs-CZ",{hour:"2-digit",minute:"2-digit"});
let mins=Math.round((new Date(ts)-new Date())/60000);

let delay="";
if(d.delay && d.delay.actual>60){
delay=` +${Math.round(d.delay.actual/60)}m`;
}

html+=`<div class="line">${t} (${mins}m) ${line} ‚Üí ${dir}${delay}</div>`;
});

document.getElementById(el).innerHTML=html;

}catch(e){
document.getElementById(el).innerHTML="nelze naƒç√≠st";
}
}

async function run(){
loadWeather();
stop("Veletr≈æn√≠","U303Z1P","v");
stop("Stross","U325Z1P","s");
}

run();
setInterval(run,60000);
</script>

</body>
</html>
